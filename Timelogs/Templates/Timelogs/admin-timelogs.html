{% extends "main.html" %}
{% load static %}


{% block content %}

<article>
    <div class="container-fluid">
        <div class="d-flex align-items-start gap-2 my-2">
            <a href="{% url 'Dashboard:admin-dashboard' %}" class="text-decoration-none"><h5 class="m-0 light-gray fw-medium">Home</h5></a>
            <span class="material-symbols-rounded light-gray">
                keyboard_arrow_right
                </span>
            <h5 class="m-0 light-gray fw-medium">Time Logs</h5>
        </div>

    </div>

    <div class="article-container">
        <div class="mt-1">
            <div class="pt-1 d-flex justify-content-between align-items-center">
                <h2 class="display-6 fw-bold dark-gray mb-3">Time Logs</h2>
                
                <form method="POST" action="{% url 'upload_timelogs' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="file" id="fileInput" name="file" accept=".xlsx, .xls" style="display: none;">
                    <button class="btn border-0 p-0" type="submit" id="uploadBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32" fill="#343b48">
                            <path d="M480-337q-8 0-15-2.5t-13-8.5L308-492q-12-12-11.5-28t11.5-28q12-12 28.5-12.5T365-549l75 75v-286q0-17 11.5-28.5T480-800q17 0 28.5 11.5T520-760v286l75-75q12-12 28.5-11.5T652-548q11 12 11.5 28T652-492L508-348q-6 6-13 8.5t-15 2.5ZM240-160q-33 0-56.5-23.5T160-240v-80q0-17 11.5-28.5T200-360q17 0 28.5 11.5T240-320v80h480v-80q0-17 11.5-28.5T760-360q17 0 28.5 11.5T800-320v80q0 33-23.5 56.5T720-160H240Z"/>
                        </svg>
                    </button>
                </form>
            </div>

            <!-- table -->
             {% if timelogs %}
                <div class="table-container">
                    <table id="requestTable">
                    <thead>
                        <tr>
                        <th class="light-gray">Time Logs Date</th>
                        <th class="light-gray">ID Number</th>
                        <th class="light-gray">Name</th>
                        <th class="light-gray">Department</th>
                        <th class="light-gray">Time In</th>
                        <th class="light-gray">Time Out</th>
                        </tr>
                    </thead>
                    <tbody class="admin-event-container">
                        {% for timelog in timelogs %}
                            <tr>
                                <td>{{timelog.log_date}}</td>
                                <td>{{timelog.employee_id.idnumber}}</td>
                                <td>{{timelog.employee_id.name}}</td>
                                <td>{{timelog.employee_id.employment_info.first.department}}</td>
                                <td>{{timelog.time_in}}</td>
                                <td>{{timelog.time_out}}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
            {% else %}
                <div class="no-filed-prf-container">                 
                    <div><h5 class="light-gray">It looks like you haven't uploaded any timelogs yet.</h5></div>
                    <img src="{% static 'images/empty-box.png' %}" alt="no data found">
                </div>
            {% endif %}
        </div>
    </div>
    
</article>

<script>
    document.getElementById('uploadBtn').addEventListener('click', function(event) {
        event.preventDefault();
        document.getElementById('fileInput').click();
    });
    
    document.getElementById('fileInput').addEventListener('change', function() {
        if (this.files.length > 0) {
            document.querySelector('form').submit();
        }
    });
</script>
{% endblock content %}